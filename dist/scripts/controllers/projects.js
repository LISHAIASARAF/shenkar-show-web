"use strict";angular.module("sbAdminApp").controller("ProjectsCtrl",function($scope,$position,$http,$q){function getProjects(){$http.get("scripts/allProjects").then(function(resp){$scope.projects=resp.data})}function getLocations(){$http.get("https://shenkar-show.herokuapp.com/locations").then(function(resp){$scope.locations=resp.data})}function getInstitutes(){$http.get("scripts/institutes.json").then(function(resp){$scope.institutes=resp.data})}function getDepartments(){return $http.get("scripts/departments.json").then(function(resp){$scope.departments=resp.data})}$scope.departments=[],$scope["new"]={manager:"1"},$scope.init=function(){getProjects(),getDepartments(),getInstitutes(),getLocations()},$scope.getDepartmentName=function(id){var name="";return $scope.departments.forEach(function(d){d._id==id&&(name=d.name)}),name},$scope.getInstituteName=function(id){var name="";return $scope.institutes.forEach(function(d){d._id==id&&(name=d.name)}),name},$scope.setEdit=function(id){return $scope.selected=null,$scope.projects.forEach(function(d){d._id==id&&($scope.selected=angular.copy(d))}),$scope.selected?void 0:!1},$scope.update=function(){$http.put("https://shenkar-show.herokuapp.com/projects/update",$scope.selected).then(function(resp){toastr.info("הנתונים נשמרו בהצלחה"),$scope.init(),$("#edit").modal("hide")})},$scope.create=function(){$http.post("https://shenkar-show.herokuapp.com/projects/create",$scope["new"]).then(function(resp){toastr.info("הנתונים נשמרו בהצלחה"),$scope.init(),$("#new").modal("hide")},function(err){})},$scope["delete"]=function(){$http.post("https://shenkar-show.herokuapp.com/projects/delete",$scope.selected).then(function(resp){toastr.info("נמחק בהצלחה"),$scope.init()})}});