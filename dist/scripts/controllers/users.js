"use strict";angular.module("sbAdminApp").controller("UsersCtrl",function($scope,$position,$http,$q){function getDepartments(){return $http.get("scripts/departments.json")}function getUsers(){return $http.get("scripts/users.json")}function getRoles(){return $http.get("scripts/roles.json")}function getInstitues(){$http.get("scripts/institutes.json").then(function(resp){$scope.institutes=resp.data})}function getAllData(){$q.all([getDepartments(),getRoles(),getUsers(),getInstitues()]).then(function(res){$scope.departments=res[0].data,$scope.roles=res[1].data,$scope.users=res[2].data})}$scope.init=function(){getAllData()},$scope["new"]={role:"1",department:"1"},$scope.getRoleName=function(id){var name="";return $scope.roles.forEach(function(r){r._id==id&&(name=r.name)}),name},$scope.getDepartmentName=function(id){var name="";return $scope.departments.forEach(function(d){d._id==id&&(name=d.name)}),name},$scope.getInstituteName=function(id){var name="";return $scope.institutes.forEach(function(d){d._id==id&&(name=d.name)}),name},$scope.setEdit=function(id){return $scope.selected=null,$scope.users.forEach(function(d){d._id==id&&($scope.selected=angular.copy(d))}),$scope.selected?void 0:!1},$scope.update=function(){$http.put("https://shenkar-show.herokuapp.com/users",$scope.selected).then(function(resp){toastr.info("הנתונים נשמרו בהצלחה"),$scope.init(),$("#edit").modal("hide")},function(){toastr.error("בעיה בשמירת הנתונים")})},$scope["delete"]=function(){$http["delete"]("https://shenkar-show.herokuapp.com/users/"+$scope.selected._id).then(function(resp){toastr.info("נמחק בהצלחה"),$scope.init()})},$scope.create=function(){$http.post("https://shenkar-show.herokuapp.com/users",$scope["new"]).then(function(resp){toastr.info("הנתונים נשמרו בהצלחה"),$scope.init(),$("#new").modal("hide")},function(){toastr.error("בעיה בשמירת הנתונים")})}});